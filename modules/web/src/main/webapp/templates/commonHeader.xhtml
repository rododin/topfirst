<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC
	"-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h ="http://java.sun.com/jsf/html"
	xmlns:f ="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.prime.com.tr/ui">

	<body>
		<ui:composition>
			<p:outputPanel id="login" style="position: absolute;right: 15px;%">
				<p:panel id="pLogin" rendered="#{!userBean.authResult}">
					<p:commandLink onclick="dLogin.show()">Login</p:commandLink>
					<h:outputText value=" | "/>
					<h:outputLink value="userRegPage.jsf">Registration</h:outputLink>
				</p:panel>
				<p:panel id="pUserInfo" rendered="#{userBean.authResult}">
					<h:outputText value="Welcome "/>
					<h:outputText value="#{userBean.firstNameOfLoggedInUser}" style="font-weight: bold" />
					<p:spacer width="10"/>
					<p:commandButton value="logout" update="login" actionListener="#{userBean.logoutAction}" />
				</p:panel>
			</p:outputPanel>

			<p:dialog header="Login" id="dLogin" widgetVar="dLogin" modal="true">
				<p:growl id="growl" life="4000" />
				<h:panelGrid columns="2" cellpadding="7">
					<h:outputText value="email*"/>
					<p:inputText value="#{userBean.email}" style="width:30" />
					<h:outputText value="password*"/>
					<p:password minLength="8" feedback="FALSE" value="#{userBean.password}"/>
					<f:facet name="footer">
						<p:commandButton value="login"
															update="growl,login"
															action="#{userBean.loginAction}"
															oncomplete="handleLoginRequest(args)" />
						<p:commandButton value="Cancel" onclick="dLogin.hide()"/>
					</f:facet>
				</h:panelGrid>
			</p:dialog>
			<script type="text/javascript">
				function handleLoginRequest(args)
				{
					if(args.loggedIn)
					{
						dLogin.hide();
					}
				}
			</script>

	</ui:composition>
	</body>

</html>
